package fix

import (
	"fmt"
	"testing"
)

type IntNode int

func (i IntNode) EqualsTo(another PathNode) bool {
	return i == another
}

type IntPath struct {
	arr []PathNode
}

func (i *IntPath) Path() []PathNode {
	return i.arr
}

func (i *IntPath) SetPath(path []PathNode) {
	i.arr = path
}

func Print(p []Path) {
	fmt.Println("---- print paths ----")
	for i, path := range p {
		fmt.Print(i, " {")
		nodes := path.Path()
		for _, node := range nodes {
			fmt.Print(node, ",")
		}
		fmt.Println("},")
	}
}

func makePath(ints [][]int) []Path {
	result := make([]Path, 0, len(ints))

	for _, arr := range ints {
		var path []PathNode
		for _, v := range arr {
			path = append(path, IntNode(v))
		}
		result = append(result, &IntPath{path})
	}

	return result
}

func TestFix(t *testing.T) {
	paths := [][]int{
		{1, 2, 3, 4, 5, 6, 7},
		{6, 7, 8, 9, 10, 11, 12},
		{4, 5, 6, 7, 8, 9, 10},
		{8, 9, 10, 11, 12, 13},
	}

	c1 := makePath(paths)
	Print(c1)
	(&CommonRootFixer{1}).Fix(c1)
	Print(c1)

	c2 := makePath(paths)
	(&CommonRootFixer{5}).Fix(c2)
	Print(c2)
}

func TestCommon_Fix(t *testing.T) {
	paths := [][]int{
		{65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,984,10627,10626,214,286,641},
		{166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,260,995,994,993,1738,4798,10637,10636,10635,10634,10633,2692,214,112,1727},
		{29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,448,2778,4061,10638},
		{150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,10654,29,207,157,51,29,155,154,153,206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,7518,10653,10652,10651},
		{29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,599,593,594,593,594,593,594,5182,2316,2966},
		{61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,664,663,662,661,660,659,9750,10657,5091,6574,10656},
		{62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,419,923,922,1909,1908,5403,5402,5401,5400,5399,10658},
		{63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,1508,1507,5116,10670,1474,455,6836},
		{50,49,29,48,29,47,29,46,29,45,29,44,29,43,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,25,24,20,19,23,21,20,19,23,21,20,19,1073,692,804,803,802,801,800,277,5},
		{13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,1116,1115,227,226,112,5},
		{61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,260,259,258,5212,253},
		{65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,8759,8758,214,112,1727},
		{51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,220,219,1469,1957,1956,1955,804,803,802,1031,1030},
		{49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,5862,10435,10434,10433},
		{61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,273,272,271,542,541,540,539,1358,1357,1356,2665},
		{169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,984,983,1087,1086,222,24,20,19,1085,1084,1083,293,292,1082,1081,292,10686,10685},
		{149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,131,130,1017,10690,748,3559,214,9500},
		{29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,2096,2095,2094,9403,9402,9401,10694,10693,10692,10691,1356,2084},
		{29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,671,670,1223,1470,5417,1114,1113,1052,1051,804,803,802,801,800,277,5},
		{62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,6694,10701,10700,3679,1649,1875,1874,510,779,778,777,1482,388},
		{63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,312,311,871,7234,10702,308,307},
		{48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,1072,1071,1070,1069,1068,1067,1066,1065,1065,1065,1065,1064,1065,1065,1063,1540,1113,1052,1051,2886,2885,5239,5238,280,5237,10711},
		{29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,312,311,871,4338,4907,10712,4391,214,112,2245},
		{51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,599,593,594,593,594,593,596,595,594,593,594,593,594,593,2969,2968,2967,925,2966},
		{60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,1897,2214,2213,2212,2211,2863,2862,2861,10717,10716,10715,10714,2998,2997,10713},
		{29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,1508,1507,5116,3616,1541,1540,1113,1052,1051,804,803,802,801,800,277,5},
		{29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,2736,6421,7033,10724,10723,10722,10721,10720},
		{63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,4125,1507,222,24,20,19,10726},
		{60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,387,386,385,384,383,382,1692,1873,1872,3734,3733,1686,3732,6391,10728},
		{29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,354,353,352,351,350,349,348,347,346,5200,7466,7465,2824,5847},
		{64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,387,1185,1504,1558,3162,10731,10222},
		{49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,6694,10701,10732},
		{64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,4329,9459,10743,10742,10741,10740},
		{60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,3927,3926,3925,3924,3923,3922,1082,1081,292,291,3576,2942,10760},
		{62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,354,353,352,6679,6678,10767,2825,2824,7412},
		{51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,3561,10772},
		{29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,260,995,994,993,2221,3490,3489,3937,1736,3936,3935,3934,10775,10774,942,10773},
		{29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,790,1406,1405,1404,1403,10780,10779,10304,10303,10778,10777,2871,10776,9398,9397},
		{40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,25,24,20,19,23,21,20,19,23,21,20,22,21,20,19,23,21,20,3038,21,20,19,23,21,20,22,21,20,19,23,21,20,3038,21,20,19,1073,692,112,5},
		{14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,2418,2417,10785,433,7417},
		{51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,131,130,129,128,2595,2594,587,3188,4096,4095,7386,3413,3412,455,1505},
		{29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,469,2920,5359,4701,4700,510,779,10795},
		{206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,234,10798,1148,1147,1146},
		{167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,387,1185,1504,1558,1557,1556,1555,1554,3970,3969,3968,3967,3966,3965,3964,10804,10803,10802,10801,10800,10799},
		{157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,43,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,599,593,594,593,598,597,594,593,594,5182,2316,924},
		{148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,440,439,4706,5385,5384,5383,5382,113,2886,2885,2884,3852},
		{167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,1377,1376,1375,1439,1438,1437,1436,1435,1434,1436,1435,1434,1433,1436,6084,6083,2825,2824,7412},
		{29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,2103,2102,2101,2100,3553,3552,3551,214,286,641},
		{65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,9387,10811,10810},
		{61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,448,10813,446,445,444,443,2424,2423,2422,2421,2420,2419,441},
		{148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,234,233,1629,1083,293,292,5125,10815,10814},
		{14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,1116,1115,5079,8286,5114},
		{29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,1897,2214,2213,2212,2211,2210,2696,2695,10835,10834},
		{29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,131,130,1017,1016,5609,5608,5607,1148,1147,1146},
		{62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,273,272,271,2142,10849,10848,1357,5441,10847},
		{60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,852,851,850,849,848,1254,1253,1252,4384,10868,10867,10866,10865,10864},
		{29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,984,983,1087,1086,222,24,20,19,1085,1084,1083,293,292,1082,1081,292,2443,1081,6124,6123,6122,510,5358,10873,10872},
		{29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,453,452,451,1022,1327,2222,805,281,280,279,278,1241,1240,1239,1238,10874},
		{62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,273,272,271,270,269,268,267,3621,10877},
		{63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,1897,2214,3204,3203,222,221,113,10882,10881},
		{29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,1897,2214,3204,3203,222,24,20,19,1444,1443,5146,5145},
		{29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,2096,2095,2094,2093,10895,10894},
		{63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,387,1185,1504,1558,1557,10898,10897,1587,10896},
		{29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,664,2655,2654,2653,2652,10899},
		{29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,671,670,1223,1470,1469,5079,5078,5114},
		{51,29,155,154,153,206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,10910,10909,4739,227,226,455,10908},
		{29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,1050,1049,1048,1047,3351,3350,3349,3348,3347,10911,6183,307},
		{29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,2972,2971,10917,10916},
		{29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,407,406,10920,10919,10918},
		{169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,224,223,1497,642,804,803,802,801,800,1241,280,1240,1239,1238,10874},
		{166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,288,6490,668,667,1970,74,1969,805,804,803,802,801,800,277,5},
		{29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,864,863,8372,10943,10942,10941,10940,2253,7853,10939},
		{62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,2096,2095,2094,9403,9402,9401,10974,10973,10972},
		{67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,2972,2971,6154,2433,2432,10982,10981,2692,214,286,641},
		{64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,354,353,352,2677,10983},
		{29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,275,274,312,311,871,4338,4907,10984},
		{29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,984,983,1087,3660,3659,3658,4765,4952,10990},
		{148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,2781,5883,5882,24,20,19,1444,7739,7738,1574,432,431},
		{61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,2373,2372,1439,1438,1437,1436,1435,1434,1436,1435,10992},
		{29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,984,983,982,981,980,532,531,527,530,529,528,527,530,529,528,527,530,529,1228,528,1228,1227,1041,190,2739},
		{29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,354,353,352,425,424,423,10995,10994,7305,10993},
		{63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,864,863,3533,3532,10233,10997,10996},
		{61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,864,863,862,1384,1383,1382,2252,2251,2250,10999,10998},
		{149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,131,130,1017,1016,5609,5608,11001,11000},
		{206,205,150,149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,2781,5681,2134,4708,2043,113,112,1727},
		{29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,1270,1269,1268,1267,5412,510,11007},
		{51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,43,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,1303,1302,1299,1301,1299,1425,1424,1423,1422,1421,1420},
		{63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,9387,5116,11014,227,226,455,11013},
		{149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,234,233,11022,11021,3308,3307,3306,1958},
		{61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,288,2409,1675,4944,1040},
		{29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,246,245,664,663,662,661,660,4617,4616,4615,4614,4613,4612,5373,5372,5371,5370,11023},
		{168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,288,640,639,24,20,1443,1442,1444,1443,5146,5145},
		{148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,599,593,596,595,594,593,11025},
		{29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,30,29,28,27,26,25,24,20,19,23,21,20,22,21,20,19,18,3037,5167},
		{60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,408,483,482,481,480,479,6101,1235,1234,1233,1232,9379,9378,1285,11029},
		{60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,208,29,207,157,51,29,155,154,153,242,260,259,258,257,256,255,11030},
		{15,14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,9352,9351,11032,11031},
		{149,148,29,51,29,204,157,51,29,54,53,52,29,51,29,50,49,29,48,29,47,29,46,29,45,29,44,29,132,29,42,29,41,29,40,29,39,38,29,37,29,36,29,35,29,34,29,33,29,32,29,31,29,763,7737,7736,24,20,19,9629,11034,11033,1007,5969},
		{29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,144,143,1377,3195,3194,6895,227,226,112,5},
		{29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,146,145,387,1185,1184,1183,3162,11037},
	}

	c2 := makePath(paths)
	(&CommonRootFixer{5}).Fix(c2)
	Print(c2)
}

func TestCommonSimple_Fix(t *testing.T) {
	paths := [][]int{
		{13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,1116,1115,227,226,112,5},
		{49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,5862,10435,10434,10433},
		{49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,152,151,150,149,148,29,51,29,147,6694,10701,10732},
		{14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,2418,2417,10785,433,7417},
		//{14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,276,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,1116,1115,5079,8286,5114},
		//{29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,2972,2971,10917,10916},
		//{67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,156,150,149,148,29,155,154,153,2972,2971,6154,2433,2432,10982,10981,2692,214,286,641},
		//{15,14,13,12,29,71,29,70,29,69,29,68,29,67,49,29,66,29,65,29,64,29,63,29,62,29,61,29,60,29,169,29,168,29,167,29,166,29,165,29,164,29,163,29,162,161,29,160,29,159,29,158,157,51,29,155,154,153,1118,1117,9352,9351,11032,11031},
	}

	c2 := makePath(paths)
	(&CommonRootFixer{5}).Fix(c2)
	Print(c2)
}
